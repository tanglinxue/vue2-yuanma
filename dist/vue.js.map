{"version":3,"file":"vue.js","sources":["../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["//重新写数组\r\n//(1) 获取原来的数组方法\r\nlet oldArrayProtoMethods = Array.prototype;\r\n\r\n//（2）继承\r\nexport let ArrayMethods = Object.create(oldArrayProtoMethods)\r\n\r\n\r\nlet methods = [\r\n  'push',\r\n  'pop',\r\n  'unshift',\r\n  'shift',\r\n  'splice',\r\n  'reverse',\r\n  'sort'\r\n]\r\n\r\nmethods.forEach(item=>{\r\n  ArrayMethods[item] = function(...args){\r\n    let result = oldArrayProtoMethods[item].apply(this,args)\r\n    let inserted\r\n    switch(item){\r\n      case 'push':\r\n      case 'unshift':\r\n        inserted = args\r\n        break\r\n      case 'splice':\r\n        inserted = args.splice(2)\r\n    }\r\n    let ob = this.__ob__;\r\n    if(inserted){\r\n      ob.observeArray(inserted)\r\n    }\r\n    return result\r\n  }\r\n})\r\n\r\n\r\n","\nimport {ArrayMethods} from './arr'\nexport function observer(data) {\n    if(typeof data != 'object' || data == null){\n      return data\n    }\n    return new Observer(data)\n}\n\nclass Observer{\n  constructor(value){\n    Object.defineProperty(value,'__ob__',{\n      enumerable:false,\n      value:this\n    })\n    //判断数据\n    if(Array.isArray(value)){\n      value.__proto__ = ArrayMethods\n      this.observeArray(value)\n    }else{\n      this.walk(value)\n    }\n  }\n  observeArray(value){\n    for(let i=0;i<value.length;i++){\n      observer(value[i])\n    }\n  }\n  walk(data){\n    let keys = Object.keys(data)\n    for(let i=0;i<keys.length;i++){\n      let key = keys[i];\n      let value = data[key];\n      defineReactive(data,key,value)\n    }\n  }\n}\n\nfunction defineReactive(data,key,value){\n    observer(value);\n    Object.defineProperty(data,key,{\n      get(){\n        console.log('获取的时候触发')\n        return value\n      },\n      set(newValue){\n        console.log('设置的时候触发')\n        if(newValue === value) return;\n        value = newValue\n        observer(value);\n      }\n    })\n}\n","import { observer } from './observe/index'\nexport function initState(vm) {\n    let opts = vm.$options;\n    if (opts.props) {\n        initProps()\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n    if (opts.watch) {\n        initWatch()\n    }\n    if (opts.computed) {\n        initComputed()\n    }\n    if (opts.methods) {\n        initMethods()\n    }\n}\nfunction initData(vm) {\n    let data = vm.$options.data;\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data;\n \n    observer(data)\n    for(let key in data){\n      proxy(vm,'_data',key)\n    }\n}\nfunction proxy(vm,source,key){\n  Object.defineProperty(vm,key,{\n    get(){\n      return vm[source][key]\n    },\n    set(newValue){\n      vm[source][key] = newValue\n    }\n  })\n}\nfunction initProps() {\n\n}\nfunction initWatch() {\n\n}\nfunction initComputed() {\n\n}\nfunction initMethods() {\n\n}\n","import { initState } from './initState'\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    let vm = this;\r\n    vm.$options = options;\r\n    initState(vm)\r\n  }\r\n}\r\n\r\n\r\n","import {initMixin} from './init'\r\n\r\nfunction Vue(options){\r\n  this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\nexport default Vue\r\n"],"names":["oldArrayProtoMethods","Array","prototype","ArrayMethods","Object","create","methods","forEach","item","_len","arguments","length","args","_key","result","apply","inserted","splice","ob","__ob__","observeArray","observer","data","_typeof","Observer","value","_classCallCheck","defineProperty","enumerable","isArray","__proto__","walk","_createClass","key","i","keys","defineReactive","get","console","log","set","newValue","initState","vm","opts","$options","props","initData","watch","computed","_data","call","proxy","source","initMixin","Vue","_init","options"],"mappings":"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"}